[PlatformTest]
type = "SandboxManagerFilter"
working_directory = "%ENV[HEKA_PLUGINS_BASE_DIR]/test"
message_signer = "PlatformTest"
max_filters = 100
[ProtobufDecoder]
[TcpPlatformTest]
type = "TcpInput"
parser_type = "message.proto"
decoder = "ProtobufDecoder"
address = ":5006"
    [TcpPlatformTest.signer.PlatformTest_0]
    hmac_key = "Platform test"


[TestDecoder]
type = "SandboxDecoder"
filename = "%ENV[HEKA_PLUGINS_BASE_DIR]/test/testDecoder.lua"
[TestInput]
type = "UdpInput"
address = ":5005"
parser_type = "regexp"
delimiter = "\n"
decoder = "TestDecoder"

[TestEncoder]
type = "SandboxEncoder"
filename = "%ENV[HEKA_PLUGINS_BASE_DIR]/test/testEncoder.lua"
[TestOutput]
type = "UdpOutput"
message_matcher = "Type == 'heka.sandbox.output' || Type == 'heka.sandbox.output.wind' || Type == 'heka.sandbox.output.all'"
address = ":5007"
encoder = "TestEncoder"

[TestLogDecoder]
type = "SandboxDecoder"
filename = "%ENV[HEKA_PLUGINS_BASE_DIR]/decoders/decode_header.lua"
    [TestLogDecoder.config]
    type_output = "log.input"
[TestLogInput]
type = "UdpInput"
address = ":5004"
parser_type = "regexp"
delimiter = "\n"
decoder = "TestLogDecoder"

[TestLogEncoder]
type = "SandboxEncoder"
filename = "%ENV[HEKA_PLUGINS_BASE_DIR]/encoders/encode_header.lua"
[TestLogOutput]
type = "UdpOutput"
message_matcher = "Type == 'heka.sandbox.log.output'"
address = ":5007"
encoder = "TestLogEncoder"
